ARRIVAL LOGOGLYPH GENERATOR
import React, { useState, useRef } from 'react';
import { Slider } from '@/components/ui/slider';
import { Button } from '@/components/ui/button';
import { Card, CardHeader, CardTitle, CardContent } from '@/components/ui/card';
import { Download, Trash } from 'lucide-react';

const HeptapodGlyphGenerator = () => {
  const [paths, setPaths] = useState([]);
  const [isDrawing, setIsDrawing] = useState(false);
  const [symmetryCount, setSymmetryCount] = useState(6);
  const [brushSize, setBrushSize] = useState(8);
  const [brushOpacity, setBrushOpacity] = useState(1);
  const [splatter, setSplatter] = useState(false);
  const [currentPath, setCurrentPath] = useState([]);
  const svgRef = useRef(null);

  const CANVAS_SIZE = 400;
  const CENTER = CANVAS_SIZE / 2;

  // Convert polar to cartesian coordinates for radial symmetry
  const toCartesian = (radius, angle) => {
    const x = CENTER + radius * Math.cos(angle);
    const y = CENTER + radius * Math.sin(angle);
    return { x, y };
  };

  // Create symmetrical points for radial strokes
  const createSymmetricalPoints = (x, y) => {
    const dx = x - CENTER;
    const dy = y - CENTER;
    const radius = Math.sqrt(dx * dx + dy * dy);
    const angle = Math.atan2(dy, dx);
    const points = [];
    
    for (let i = 0; i < symmetryCount; i++) {
      const newAngle = angle + (2 * Math.PI * i) / symmetryCount;
      points.push(toCartesian(radius, newAngle));
    }
    
    return points;
  };

  // Handle drawing with mouse movement
  const handleMove = (e) => {
    if (!isDrawing) return;

    const svg = svgRef.current;
    const rect = svg.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;

    const newPoints = createSymmetricalPoints(x, y);
    setCurrentPath((prev) => [...prev, ...newPoints]);
  };

  // Complete the current stroke
  const completePath = () => {
    if (currentPath.length > 0) {
      setPaths((prev) => [...prev, currentPath]);
      setCurrentPath([]);
    }
    setIsDrawing(false);
  };

  // Export the SVG
  const exportSVG = () => {
    const svgData = svgRef.current.outerHTML;
    const blob = new Blob([svgData], { type: 'image/svg+xml' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = 'heptapod-glyph.svg';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(url);
  };

  return (
    <Card className="w-full max-w-3xl mx-auto">
      <CardHeader>
        <CardTitle>Heptapod Glyph Generator</CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          <div className="relative">
            <svg
              ref={svgRef}
              width={CANVAS_SIZE}
              height={CANVAS_SIZE}
              className="border rounded-full bg-black"
              onMouseDown={() => setIsDrawing(true)}
              onMouseMove={handleMove}
              onMouseUp={completePath}
              onMouseLeave={completePath}
            >
              <circle cx={CENTER} cy={CENTER} r={CANVAS_SIZE / 2 - 2} fill="none" stroke="#333" strokeWidth="1" />
              {paths.map((path, i) => (
                <path
                  key={i}
                  d={`M ${path[0].x} ${path[0].y} ${path.slice(1).map(p => `L ${p.x} ${p.y}`).join(' ')}`}
                  fill="none"
                  stroke="white"
                  strokeWidth={brushSize}
                  strokeOpacity={brushOpacity}
                  strokeLinecap="round"
                />
              ))}
              {currentPath.length > 0 && (
                <path
                  d={`M ${currentPath[0].x} ${currentPath[0].y} ${currentPath.slice(1).map(p => `L ${p.x} ${p.y}`).join(' ')}`}
                  fill="none"
                  stroke="white"
                  strokeWidth={brushSize}
                  strokeOpacity={brushOpacity}
                  strokeLinecap="round"
                />
              )}
            </svg>
          </div>

          <div className="space-y-4">
            <div className="flex items-center gap-4">
              <span className="w-24">Symmetry:</span>
              <Slider value={[symmetryCount]} onValueChange={(v) => setSymmetryCount(v[0])} min={2} max={12} />
            </div>

            <div className="flex items-center gap-4">
              <span className="w-24">Brush Size:</span>
              <Slider value={[brushSize]} onValueChange={(v) => setBrushSize(v[0])} min={1} max={20} />
            </div>

            <div className="flex items-center gap-4">
              <span className="w-24">Opacity:</span>
              <Slider value={[brushOpacity]} onValueChange={(v) => setBrushOpacity(v[0])} min={0.1} max={1} step={0.1} />
            </div>

            <div className="flex items-center gap-4">
              <Button onClick={exportSVG}>
                <Download className="w-4 h-4 mr-2" /> Export SVG
              </Button>
              <Button variant="destructive" onClick={() => setPaths([])}>
                <Trash className="w-4 h-4 mr-2" /> Clear
              </Button>
              <label>
                Splatter: <input type="checkbox" checked={splatter} onChange={() => setSplatter(!splatter)} />
              </label>
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  );
};

export default HeptapodGlyphGenerator;
